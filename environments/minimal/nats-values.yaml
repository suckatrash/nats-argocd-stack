config:
  cluster:
    enabled: true
    replicas: 3
    name: nats-minimal-cluster
  
  jetstream:
    enabled: true
    fileStore:
      pvc:
        size: 10Gi
        storageClassName: standard-rwo
      dir: /data/jetstream
    memStore:
      enabled: true
      maxSize: 1Gi
  
  tls:
    enabled: true
    secretName: nats-tls-cert
    ca: ca.crt
    cert: tls.crt
    key: tls.key
    verify: false

nats:
# Delete the old manual application
kubectl delete application nats-minimal -n argocd

# Create new one that watches Git
cat > environments/minimal/nats-application.yaml <<EOF
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: nats-  name: nats-  name: nats-  name: nater  name: nats-  name: nats-.a go  name: natsio  name: nats-ec  name: nats-  nso  name: nats-  nameAR  name: nats-  ry  name: nats-  name: natss-  name: n.i  name: nats-ar  name  chart:   name   targetRevisi  name: nats-  name: n    # V  name: nats-  name: nats-     valueFiles:
      - $values/environments/minimal/nats-values.yaml
    
    # Reference to your Git repo for values
    - repoURL: https://github.com/suckatrash/nats-argocd-stack.git
      targetRevision: HEAD
      ref: values
  
  destination:
      image:
    repository: nats
    tag: 2.10-alpine
  
  resources:
    requests:
      cpu: 100m
      memory: 128Mi
    limits:
      cpu: 500m
      memory: 512Mi

natsbox:
  enabled: true
  resources:
    requests:
      cpu: 10m
      memory: 32Mi
    limits:
      cpu: 100m
      memory: 128Mi

service:
  enabled: true
  ports:
    client:
      port: 4222
    monitoring:
      port: 8222
    cluster:
      port: 6222
